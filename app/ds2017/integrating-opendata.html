<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Integrating Open Data</title>

		<link rel="shortcut icon" href="../favicon.ico">

		<meta name="description" content="Integrating Open Data">
		<meta name="author" content="Mike Juniper">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="../styles/reveal-newer.css">
		<link rel="stylesheet" href="../styles/theme/esri-dev-summit-2017.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="../lib/css/solarized_dark.css">

  	<link rel="stylesheet" href="../styles/devsummit-2017.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../styles/print/pdf.css' : '../styles/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

      <div class="slides">
        <section class="title"  data-background="../images/title-2017b.png" data-background-size="cover">
          <h1>Integrating Open Data</h1>
          <p>
            <h4><a href="https://github.com/mjuniper">Mike Juniper</a> :: Washington DC R&amp;D Center</h4>
            <h4><a href="https://github.com/akharris">Alex Harris</a> :: Washington DC R&amp;D Center</h4>
          </p>
        </section>

        <section>
          <div>
            <h2>
              <a href="http://mjuniper.github.io/presentations/ds2017/integrating-opendata.html">mjuniper.github.io/presentations/ds2017/integrating-opendata.html</a>
            </h2>
          </div>

          <div class="topmargin">
            <h4>
              <a href="https://github.com/mjuniper/presentations">github.com/mjuniper/presentations</a>
            </h4>
          </div>
        </section>

        <section>
          <h1>ArcGIS Open Data</h1>

          <aside class="notes">
            <h4>Make your authoritative data:</h4>
            <ul>
              <li>Discoverable</li>
              <li>Explorable</li>
              <li>Accessible</li>
            </ul>
            <h4>the high level flow is</h4>
            <ol>
              <li>enable OD on your org</li>
              <li>share data to OD groups</li>
              <li>create an OD site</li>
            </ol>
          </aside>
        </section>

        <section>
          <img src="../images/la-geohub.png" data-transition-out="fade">
        </section>

				<section data-transition="fade">
          <img src="../images/hifld.png">
        </section>

        <section data-transition="fade">
          <img src="../images/d3.png">
        </section>

        <section data-transition="fade">
          <img src="../images/halifax.png">
        </section>

        <section data-transition="fade">
          <img src="../images/summit.png">
        </section>

        <section data-transition="fade">
          <img src="../images/brampton.png">
        </section>

        <section data-transition="fade">
          <img src="../images/loudoun.png">
        </section>

        <section data-transition="fade">
          <img src="../images/raleigh.png">
        </section>

        <section data-transition="fade">
          <img src="../images/umbrella.png">

          <aside class="notes">
            <h4>but what if...</h4>
            <ul>
              <li>site customization capabilities insufficient</li>
              <li>bring AGO OD into existing website</li>
              <li>expose data from other systems in ArcGIS OD</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Interoperability</h1>
          <ul>
            <li class="fragment">
              <a href="http://koopjs.github.io/">Koop</a>
            </li>
            <li class="fragment">
              <a href="http://www.w3.org/TR/vocab-dcat/">DCAT</a>
            </li>
            <li class="fragment">
              <a href="https://opendata.arcgis.com/api/v2/">Open Data API</a>
            </li>
            <li class="fragment">
              <a href="https://github.com/esridc/opendata-search-component">Open Data Search web component</a>
            </li>
            <li class="fragment">
              <a href="https://github.com/mjuniper/OpenData-Backbone">Building</a> an <a href="https://github.com/mjuniper/opendata-ember">app</a> against the API
            </li>
          </ul>
        </section>

        <section>
          <h1>koop</h1>
					<h3>Alex Harris</h3>
          <h3 class="fragment">Connect APIs to ArcGIS</h3>
          <ul>
            <li class="fragment">
              Open Source (<a href="https://github.com/Esri/koop">github.com/Esri/koop</a>) R &amp; D
            </li>
            <li class="fragment">
              <a href="http://nodejs.org">node js</a>
            </li>
            <li class="fragment">
              Converts third-party APIs into Feature Services
            </li>
            <li class="fragment">
              export as kml, csv, shp
            </li>
          </ul>
        </section>

        <section>
          <img id="architecture" src="../images/arch.jpeg">
        </section>

        <section>
          <h1>Koop Providers</h1>
          <ul>
            <li class="fragment">
              Responsible for translating API into GeoJSON
            </li>
            <li class="fragment">
              Koop handles GeoJSON to Geoservices transformation
            </li>
          </ul>
        </section>

        <section>
          <h1>Koop Providers</h1>
          <h3>Example: Socrata Provider</h3>

          <div class="fragment">
            <a class="follow-link" href="https://data.seattle.gov/Community/Schools/pmap-kbvr" target="_blank">data.seattle.gov/Community/Schools/pmap-kbvr</a>
          </div>

          <div class="fragment">
            <a class="follow-link" href="http://data.seattle.gov/resource/2tje-83f6.json" target="_blank">data.seattle.gov/resource/pmap-kbvr.json</a>
          </div>

          <div class="fragment">
            <h3>Via koop:</h3>
            <a class="follow-link" href="http://koop.dc.esri.com/socrata/seattle/2tje-83f6/FeatureServer/0" target="_blank">koop.dc.esri.com/socrata/seattle/pmap-kbvr/FeatureServer/0</a>
          </div>

          <div class="fragment">
            <h3>Registered as an item in ArcGIS Online:</h3>
            <a class="follow-link" href="http://dcdev.maps.arcgis.com/home/item.html?id=8b6ecc9845944908a77a197eed908838" target="_blank">dcdev.maps.arcgis.com/home/item.html?id=8b6ecc9845944908a77a197eed908838</a>
          </div>

          <div class="fragment">
            <h3>Shared through Open Data:</h3>
            <a class="follow-link" href="https://opendata.arcgis.com/datasets/dcdev::seattle-socrata-2tje-83f6" target="_blank">opendata.arcgis.com/datasets/dcdev::seattle-socrata-pmap-kbvr</a>
          </div>
        </section>

        <section>
          <h1>Koop Providers (for Koop >= 3.0)</h1>
          <h3>Requirements</h3>
          <ul>
            <li class="fragment">
              Docs are found at <a class='follow-link' href='https://koopjs.github.io/docs/specs/provider/' target='_blank'>koopjs.github.io/docs/specs/provider/</a>
            </li>
            <li class="fragment">
              Implement a single function
            </li>
            <li class="fragment">
              That function fetches data from remote API and translates it into GeoJSON
            </li>
            <li class="fragment">
              Koop handles the rest
            </li>
          </ul>
        </section>

        <section>
          <h1>Koop demo</h1>

          <ul>
            <li class="fragment">Using the following</li>
            <li class="fragment">Open Data from <a class='follow-link' href="http://opendata.dc.gov" target="_blank">City of DC</a></li>
            <li class="fragment">Koop Providers for Zillow, Craigslist, and Yelp</li>
            <li class="fragment"><a class='follow-link' href="http://dcdev.maps.arcgis.com/home/webmap/viewer.html?webmap=5473e98c05194a3fae37e11723047af1" target="_blank">Quick Demo</a></li>
          </ul>
        </section>

        <section>
          <h1>DCAT</h1>

					<a href="http://geohub.lacity.org/data.json">geohub.lacity.org/data.json</a>
					<div>
						<div>
							or:
						</div>
						&lt;your site&gt;-&lt;your organization&gt;.opendata.arcgis.com/data.json
          </div>

          <div class="fragment">
            DCAT enables integration with CKAN portals such as data.gov
          </div>
        </section>

        <section>
          <h1>Open Data API</h1>
        </section>

        <section>
          <h1>What is the Open Data API?</h1>

          <div class="fragment">
            It is not the Portal API
          </div>
          <div class="fragment">
            It is not the GeoServices API
          </div>
          <div class="fragment">
            It is used for finding Open Data Datasets &amp; managing Open Data Sites
          </div>

        </section>

        <section>
          <h1>Simple API example</h1>
					<pre class="fragment">
        		<code class="hljs">https://opendata.arcgis.com</code>
        	</pre>
					<pre class="fragment">
        		<code class="hljs">/api/v2</code>
        	</pre>
					<pre class="fragment">
		        	<code class="hljs">/datasets</code>
	        	</pre>
					<pre class="fragment">
			      <code class="hljs">?q=crime&amp;page[size]=5&amp;page[number]=3</code>
        	</pre>

					<aside class="notes">
						Breakdown an URL into it component parts.
						Domain, URI, some resource, and Query string.
						This should look familar to anyone that's used.
					</aside>

          <div class="fragment">
            <h3>Example:</h3>
            <a href="https://opendata.arcgis.com/api/v2/datasets?q=water&page[size]=5&page[number]=3" class="fragment follow-link" target="_blank">https://opendata.arcgis.com/api/v2/datasets?q=water&page[size]=5&amp;page[number]=3</a>
          </div>
          <!--
            Notice the only difference between these URLs is the .jon extension, but the results are considerably different.
          -->
        </section>

        <section>
          <h1>An Aside on the V1 API</h1>
          <div>
            Don't Use It
          </div>
        </section>

        <section>
          <h1>What uses the OpenData API?</h1>
          <div class="fragment">OpenData "Umbrella" (Ember)</div>
          <div class="fragment">OpenData Custom Sites 2.X (Ember)</div>
          <div class="fragment">OpenData Admin 2.0 (Ember)</div>
        </section>

        <section>
          <h1>OpenData V2 API</h1>
          <div class="fragment">Versioning via URL</div>
          <div class="fragment">API returns JSON</div>
          <div class="fragment">adheres to JSONAPI standard</div>

          <div class="fragment">
            <h3><pre><code class="hljs">/api/v2/{:resource}</code></pre></h3>
            <h3><pre><code class="hljs">/api/v2/{:resource}/{:id}</code></pre></h3>
            <h3><pre><code class="hljs">/api/v2/{:resource}/{:id}/{:related_resource}</code></pre></h3>
          </div>
        </section>

        <section>
          <h1>Why JSONAPI?</h1>
          <div class="fragment">Standardizes JSON responses</div>
          <div class="fragment">Supports features like side-loading</div>
          <div class="fragment">Supports client-defined payloads</div>
          <div class="fragment">Has many client and server implementations</div>

          <div class="fragment">Go to <a href="http://jsonapi.org/implementations/">http://jsonapi.org/implementations/</a> for client and server libraries</div>
          <div class="fragment">Go to <a href="http://jsonapi.org/format">http://jsonapi.org/format</a> for the spec</div>
        </section>

        <section>
          <h1>OpenData V2 API: Query Abilities</h1>
          <div class="fragment">Full text queries supported with the `q` parameter</div>
          <div class="fragment"><a target="_blank" href="https://opendata.arcgis.com/api/v2/datasets?q=parcels">/api/v2/datasets?q=parcels</a></div>
          <div class="fragment">Can 'side-load' related resources in a single request via `include` parameter</div>
          <div class="fragment">"Bring me all the datasets that match the query 'parcel' and also include the organizations that published those datasets"</div>
          <div class="fragment"><a target="_blank" href="https://opendata.arcgis.com/api/v2/datasets?q=parcels&include=organizations">/api/v2/datasets?q=parcels&include=organizations</a></div>
        </section>

        <section>
          <h1>OpenData V2 API: Response Format</h1>
          <h2 class="fragment">Standardized response for a resource or a collection of resources</h2>
          <div class="fragment">
            <pre><code class="hljs">/api/v2/datasets -> {"data": []}</code></pre>
            <pre><code class="hljs">/api/v2/datasets/:id -> {"data": {}}</code></pre>
          </div>
        </section>

        <section>
          <h1>OpenData V2 API: Object Format</h1>
          <div class="fragment">Each object has a standard format</div>
<pre class="fragment"><code class="hljs json">
{
  "id": "f2e1c2ef9eb44f2899f4a310a80ecec9_2",
  "type": "dataset",
  "attributes": {
    "name": ...,
    "url": ...,
    "recordCount": ...,
  }
}
</code></pre>
        </section>

        <section>
          <h1>OpenData V2 API: Side-Loaded Resources</h1>
          <div class="fragment">How are side-loaded resources returned?</div>
<pre class="fragment"><code class="hljs json">
{
  "data": [...],
  "included": [
    {
      "id": "afd7refdr",
      "type": "organization",
      "attributes": {
        "name": ...,
        "homePageUrl": ...,
      }
    }
  ]
}
</code></pre>
        </section>

        <section>
          <h1>OpenData V2 API: Metadata</h1>
          <h2>Aggregations included on each request for collections</h2>

          <pre class="fragment"><code class="hljs json">
{
  "data": [...],
  "meta": {
    "apiRoot": "https://opendata.arcgis.com/api/v2/",
    "resourceRoot": "https://opendata.arcgis.com/api/v2/datasets/",
    "queryParameters": {
      query-parameters-of-request...
    },
    "stats": {
      counts-and-other-aggregations
    }
  }
}
          </code></pre>

				</section>

        <section>
          <h1>OpenData V2 API: Request Metadata Example</h1>
          <div class="fragment">/api/v2/datasets?q=population&filter[content]=spatial%20dataset&page[size]=25</div>

          <pre class="fragment code-lots"><code class="hljs json" data-trim>
{
  "meta": {
    "apiRoot": "http://opendata.arcgis.com/api/v2",
    "resourceRoot": "http://opendata.arcgis.com/api/v2/datasets",
    "queryParameters": {
      "page": {
        "number": 1,
        "size": 25
      },
      "q": "population",
      "filter": {
        "content": "spatial dataset"
      }
    },
    "stats": {
      "count": 10,
      "totalCount": 186,
      "aggs": {
        "content": [{ "key": "spatial dataset", "docCount": 186 }],
        "tags": [
          { "key": "census", "docCount": 162 },
          { "key": "population", "docCount": 97 },
          { "key": "demographics", "docCount": 71 },
          { "key": "acs": "docCount": 21}
        ],
        "source": [
          { "key": "U.S. Federal Maps and Apps", "docCount": 24 },
          { "key": "Miami-Dade County, Florida", "docCount": 11 }
        ]
      }
    }
  }
}
          </code></pre>
        </section>

        <section>
          <h1>OpenData V2 API: Pagination</h1>
          <div class="fragment">/api/v2/datasets?q=population&filter[content]=spatial%20dataset&page[size]=25</div>

          <pre class="fragment"><code class="hljs json">
{
  "data": [...],
  "meta": {...},
  "links": {
    "first": "https://opendata.arcgis.com/api/v2/datasets?page[number]=1&page[size]=25&q=population&filter[content]=spatial%20dataset",
    "next": "https://opendata.arcgis.com/api/v2/datasets?page[number]=2&page[size]=25&q=population&filter[content]=spatial%20dataset",
    "last": "https://opendata.arcgis.com/api/v2/datasets?page[number]=8&page[size]=25&q=population&filter[content]=spatial%20dataset"
  }
}
          </code></pre>
        </section>

        <section>
          <h1>OpenData V2 API: Pagination</h1>
          <h3>Zoom In On the Paging Parameters</h3>
          <div class="fragment">/api/v2/datasets?q=population&filter[content]=spatial%20dataset&page[size]=25</div>

          <pre class="fragment"><code class="hljs json">
{
  "data": [...],
  "meta": {...},
  "links": {
    "first": "...?page[number]=1&page[size]=25&q=population&filter[content]=spatial%20dataset",
    "next": "...?page[number]=2&page[size]=25&q=population&filter[content]=spatial%20dataset",
    "last": "...?page[number]=8&page[size]=25&q=population&filter[content]=spatial%20dataset"
  }
}
          </code></pre>
        </section>


        <section>
          <h1>OpenData V2 API: Standardized Errors</h1>
        	<div class="fragment">/api/v2/datasets?foo=bar</div>
					<pre class="fragment"><code class="hljs json">
{
  "errors": [
    {
      "title": "Unrecognized Parameter",
      "detail": "'foo' is not a recognized parameter for this request.",
      "status": 400,
      "source": { "parameter": "foo=bar" },
      "meta": { detailed-information-to-debug-the-request }
    }
  ]
}
					</code></pre>
        </section>

        <section>
          <h1>OpenData V2 API: More Standardized Errors</h1>
        	<div class="fragment">/api/v2/datasets?foo=bar&filter[pizza]=anchovies</div>
        	<div class="fragment">All errors are processed before a response is generated</div>
					<pre class="fragment code-lots"><code class="hljs json">
{
  "errors": [
    {
      "title": "Unrecognized Parameter",
      "detail": "'foo' is not a recognized parameter for this request.",
      "status": 400,
      "source": { "parameter": "foo=bar" },
      "meta": { detailed-information-to-help-debug-the-request }
    },
    {
      "title": "Invalid filter key",
      "detail": "'filter[pizza]' is not a valid filter key",
      "status": 400,
      "source": { "parameter": "filter[pizza]" },
      "meta": { detailed-information-to-help-debug-the-request }
    }
  ]
}
					</code></pre>
        	<div class="fragment"><a target="_blank" href="https://opendata.arcgis.com/api/v2/datasets?foo=bar&filter[pizza]=anchovies">Try it yourself</a></div>
        </section>


        <section>
          <h1>OpenData V2 API Sandbox</h1>
          <div class="fragment">Unoffical ArcGIS Open Data API Sandbox at </div>
          <div class="fragment"><a href="http://akharris.github.io/ember-arc-swag/">http://akharris.github.io/ember-arc-swag/</a></div>
        </section>

        <section>
          <h1>Embedded Open Data</h1>
          <div class="fragment">
            <a href="http://esridc.github.io/opendata-search-component/examples/">Open Data Search Web Component</a>
          </div>
          <div class="fragment">
            <a href="https://github.com/esridc/opendata-search-component">github.com/esridc/opendata-search-component</a>
          </div>
        </section>

        <section>
          <h1>What can you do with the Open Data API?</h1>

          <div id="build-an-app" class="fragment">
            <h2>Build an app!</h2>
          </div>
        </section>

        <section>
          <img class="screen-shot" src="../images/umbrella.png">
          <h2><a class="follow-link" href="http://opendata.arcgis.com" target="_blank">ArcGIS Open Data</a></h2>

          <aside class="notes">Open Data is built against the same API</aside>
        </section>

        <section>
          <img src="../images/api-arch.png">

          <aside class="notes">
            <ul>
              <li>A static website that makes http requests for data</li>
            </ul>
          </aside>
        </section>

        <section>
          <pre><code class="hljs">
$.getJSON('http://my.api.url')
  .done(function (response, status, xhr) {
    /* stuff it into the DOM... */
  })
  .fail(function (xhr, status, error) {
    /* do something about the error! */
  });
          </code></pre>

          <aside class="notes">
            <ul>
              <li>if you're familiar with jquery, you might do something like this</li>
            </ul>
          </aside>
        </section>

        <section class="strikethrough" data-transition="fade" data-transition-speed="slow">
          <pre><code class="hljs">
$.getJSON('http://my.api.url')
  .done(function (response, status, xhr) {
    /* do something with the response! */
  })
  .fail(function (xhr, status, error) {
    /* do something about the error! */
  });
          </code></pre>

          <aside class="notes">
            <ul>
              <li>but unless you're building a trivial app, don't do it that way</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1 id="mvc">MV<span>*</span></h1>

          <aside class="notes">
            <ul>
              <li>use an mvc framework instead</li>
            </ul>
          </aside>
        </section>

        <section>
          <img class="framework-logo" src="../images/0cf15665a9146ba852bf042b0652780a.png">
          <img class="framework-logo" src="../images/vue.png">
          <img class="framework-logo" src="../images/react-logo-1000-transparent.png">

          <img class="framework-logo" src="../images/angularjs-for-header-only.svg">
          <img class="framework-logo" src="../images/backbone.png">
          <img class="framework-logo" src="../images/marionette.svg">

          <aside class="notes">
            <ul>
              <li>like one of these</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Key endpoints:</h1>
          <div class="fragment">
            <pre><code class="hljs">/api/v2/datasets?q=&lt;search string&gt;&page[number]=&lt;page number&gt;</code></pre>
            <a class="follow-link" href="http://opendata.arcgis.com/api/v2/datasets?q=water&page[number]=1" target="_blank"></a>
          </div>

          <div class="fragment">
            <pre><code class="hljs">$.getJSON(MyApiUrl + '/api/v2/datasets?q=water&page[number]=1');</code></pre>
          </div>

          <div class="fragment">
            <div>and</div>
            <pre><code class="hljs">/api/v2/datasets/&lt;id&gt;</code></pre>
            <a class="follow-link" href="http://opendata.arcgis.com/api/v2/datasets/354b5206149c4863abf3d77710063489_2" target="_blank"></a>
          </div>

          <div class="fragment">
            <pre><code class="hljs">$.getJSON(MyApiUrl + '/api/v2/datasets/abc123');</code></pre>
          </div>

          <aside class="notes">
            <ul>
              <li>jsonview</li>
              <li>overall structure of the JSON</li>
              <li>
                key attributes:
                <ul>
                  <li>id</li>
                  <li>type</li>
                  <li>url - points you to where the data actually lives</li>
                </ul>
              </li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>And maybe:</h1>

          <div class="fragment">
            <pre><code class="hljs">/api/v2/datasets/&lt;id&gt;/related</code></pre>
            <a class="follow-link" href="http://opendata.arcgis.com/api/v2/datasets/354b5206149c4863abf3d77710063489_2/related" target="_blank"></a>
          </div>

          <div class="fragment">
            <pre><code class="hljs javascript">$.getJSON(MyApiUrl + '/api/v2/datasets/abc123/related');</code></pre>
          </div>

          <div class="fragment">
            <div>And:</div>
            <pre><code class="hljs">/datasets/autocomplete?query=&lt;search string&gt;</code></pre>
            <a class="follow-link" href="http://opendata.arcgis.com/datasets/autocomplete.json?query=wate" target="_blank"></a>
          </div>

          <div class="fragment">
            <pre><code class="hljs">$.getJSON(MyApiUrl + '/datasets/autocomplete?query=wat');</code></pre>
          </div>
        </section>

        <section>
          <h1>Also:</h1>
          <div class="fragment">
            <pre><code class="hljs html">/datasets/&lt;id&gt;.csv</code></pre>
            <a class="follow-link" href="http://opendata.arcgis.com/datasets/9874ff4f0bc84bfa9e9cb5326b36f3b0_1.csv" target="_blank"></a>
          </div>

          <div class="fragment">
            <pre><code class="hljs html">/datasets/&lt;id&gt;.geojson</code></pre>
            <a class="follow-link" href="http://opendata.arcgis.com/datasets/9874ff4f0bc84bfa9e9cb5326b36f3b0_1.geojson" target="_blank"></a>
          </div>

          <div class="fragment">
            <pre><code class="hljs html">/datasets/&lt;id&gt;.kml</code></pre>
            <a class="follow-link" href="http://opendata.arcgis.com/datasets/9874ff4f0bc84bfa9e9cb5326b36f3b0_1.kml" target="_blank"></a>
          </div>

          <div class="fragment">
            <pre><code class="hljs html">/datasets/&lt;id&gt;.zip</code></pre>
            <a class="follow-link" href="http://opendata.arcgis.com/datasets/9874ff4f0bc84bfa9e9cb5326b36f3b0_1.zip" target="_blank"></a>
          </div>
        </section>

        <section>
          <h1>Errors...</h1>

          <img src="../images/errors.png" style="width:40%;">
          <a class="follow-link" href="http://opendata.arcgis.com/api/v2/datasets/sdhkdhsf" target="_blank"></a>

          <aside class="notes">
            <ul>
              <li>errors are handled how you'd expect - http status code</li>
              <li>4xx means there was something wrong with the request</li>
              <li>As mentioned earlier there will be plenty of details in the error message itself</li>
              <li>5xx means the API goofed up</li>
            </ul>
          </aside>
        </section>

        <section>
          <pre><code class="hljs">
$.getJSON('http://my.api.url')
  .done(function (response, status, xhr) {
    if (response.error) {
      /* you don't have to do this! */
    }
  })
  .fail(function (xhr, status, error) {
    switch (xhr.status) {
      case 404:
        /* handle 404 */
      default:
        /* handle other errors */
    }
  });
          </code></pre>

          <aside class="notes">
            <ul>
              <li>so you can handle errors like you'd expect</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Gotcha's:</h1>
          <ul>
						<li class="fragment">SSL only (https://opendata.arcgis.com/api/v2)</li>
						<li class="fragment">Currently no JSONP support</li>
            <li class="fragment">Does support CORS</li>
            <li class="fragment">But ... <a href="https://blogs.msdn.microsoft.com/ieinternals/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds/">IE &lt; 10</a></li>
          </ul>
        </section>

        <section>
          <img class="screen-shot" src="../images/opendata-backbone.png">
          <h2><a class="follow-link" href="http://esridc.github.io/OpenData-Backbone" target="_blank">esridc.github.io/OpenData-Backbone</a></h2>
        </section>

        <section>
          <img class="framework-logo" src="../images/backbone.png">
          <img class="framework-logo" src="../images/marionette.svg">
          <img class="framework-logo" src="../images/bootstrap-logo.png">

          <aside class="notes">
            <ul>
              <li>Backbone &amp; Marionette because I know them well and could build it quickly</li>
              <li>Also because even if you don't use them, it's pretty easy to understand</li>
              <li>Bootstrap because it's widely known, well documented, and extensible</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Ok,... how?</h1>

          <div class="fragment">
            Fork it: <a class="follow-link" href="https://github.com/esridc/OpenData-Backbone" target="_blank">github.com/esridc/OpenData-Backbone</a>
            <div>then:</div>
          </div>
          <div class="fragment">
            <pre class="code">
              <code class="hljs">
$ git clone https://github.com/esridc/OpenData-Backbone.git
$ cd opendata-backbone
$ npm install
$ bower install
$ gulp serve
              </code>
            </pre>
          </div>
        </section>

        <section>
          <h1>In backbone-land...</h1>
        </section>

        <section>
          <pre><code class="hljs">
DatasetCollection = Backbone.Collection.extend({
  url: function () {
    //get the params (q=, page=, etc) from somewhere...
    var queryParams = '';
    return MyOD.config.api + 'datasets?' + queryParams;
  },

  parse: function (resp) {
    return resp.data;
  }
});
          </code></pre>
          <a class="follow-link" target="_blank" href="https://github.com/mjuniper/OpenData-Backbone/blob/master/app/scripts/entities/dataset-collection.js#L13"></a>
        </section>

				<section>
          <pre><code class="hljs">
DatasetModel = Backbone.Model.extend({
  url: function () {
    return MyOD.config.api + 'datasets/' + this.get('id');
  },

  parse: function (response) {
    return response.data;
  }
});
          </code></pre>
				</section>

				<section>
          <img class="screen-shot" src="../images/opendata-backbone.png">
          <h2><a class="follow-link" href="http://esridc.github.io/opendata-ember" target="_blank">esridc.github.io/opendata-ember</a></h2>
        </section>

        <section>
          <img class="framework-logo" src="../images/0cf15665a9146ba852bf042b0652780a.png">
          <img class="framework-logo" src="../images/bootstrap-logo.png">

          <aside class="notes">
            <ul>
              <li>We were pretty sure we wanted to use ember for v2</li>
              <li>Fits nicely with our v2 api because ember data</li>
              <li>Bootstrap because it's widely known, well documented, and extensible</li>
            </ul>
          </aside>
        </section>

				<section>
          <div>
            Fork it: <a class="follow-link" href="https://github.com/esridc/opendata-ember" target="_blank">github.com/esridc/opendata-ember</a>
            <div>then:</div>
          </div>
          <div class="fragment">
            <pre class="code">
              <code class="hljs">
$ npm install -g ember-cli
$ git clone https://github.com/esridc/opendata-ember.git
$ cd opendata-ember
$ npm install
$ bower install
$ ember serve
              </code>
            </pre>
          </div>
        </section>

        <section>
          <h1>In ember-land...</h1>
        </section>

        <section class="code-only">
          <pre><code class="hljs" data-trim>
import Ember from 'ember';
import DS from 'ember-data';

export default DS.JSONAPIAdapter.extend({

  host: ENV.APP.API,

  namespace: 'api/v2',

  pathForType: function(type) {
    const camelized = Ember.String.camelize(type);
    return Ember.String.pluralize(camelized);
  },

  urlForFindRecord: function (id/*, modelName, snapshot*/)  {
    const host = this.get('host');
    const namespace = this.get('namespace');
    return `${host}/${namespace}/datasets/${id}`;
  }

});
          </code></pre>

        </section>

				<section class="code-only">
          <pre><code class="hljs" data-trim>
import Ember from 'ember';
import DS from 'ember-data';

export default DS.JSONAPISerializer.extend({
  normalizeResponse: function (store, primaryModelClass, payload/*, id, requestType*/) {
    if (Ember.isArray(payload.data)) {
      payload.data = payload.data.map(this._mapDataset);
    } else {
      payload.data = this._mapDataset(payload.data);
    }
    return payload;
  },

  _mapDataset: function (item) {
    if(!item.attributes.name){
      item.attributes.name = item.attributes.item_name;
    }
    return item;
  }
});
          </code></pre>
				</section>

        <section>
          <h1>Or:</h1>
          <pre class="code">
            <code class="hljs">
$ ember install ember-arcgis-opendata-services
            </code>
          </pre>
        </section>

        <section>
          <pre class="code">
            <code class="hljs">
// datasets route
model: function (params) {
  const qryParams = ...
  return this.store.query('dataset', qryParams);
},
            </code>
          </pre>
          <pre class="code">
            <code class="hljs">
// datasets.dataset route
model: function (params) {
  return this.store.findRecord('dataset', params.id);
},
            </code>
          </pre>
        </section>

        <section>
          <h1>More to come?</h1>
          <img class="framework-logo" src="../images/vue.png">
          <img class="framework-logo" src="../images/react-logo-1000-transparent.png">
          <img class="framework-logo" src="../images/angularjs-for-header-only.svg">
        </section>

        <section>
          <ul>
            <li><a href="http://mjuniper.github.io/presentations/ds2017/integrating-opendata.html">mjuniper.github.io/presentations/ds2017/integrating-opendata.html</a></li>
            <li><a href="http://koopjs.github.io">koopjs.github.io</a></li>
            <li><a href="http://jsonapi.org">jsonapi.org</a></li>
            <li><a href="http://akharris.github.io/ember-arc-swag">akharris.github.io/ember-arc-swag</a> (not API feature-complete but still useful)</li>
            <li><a href="http://emberjs.com">emberjs.com</a></li>
            <li><a href="http://backbonejs.org">backbonejs.org</a></li>
          </ul>
        </section>

        <section data-background="../images/end-2017.png" data-background-size="cover">
          <!-- <h1>Rate This Session</h1>
          <h2><a href="http://www.esri.com/RateMyDevSummitSession">www.esri.com/RateMyDevSummitSession</a></h2> -->
        </section>

      </div>

      <div id="slide-footer">
        <div class="left">
          Esri Dev Summit 2017 | Integrating Open Data
        </div>
        <div class="right">
          <a href="http://mjuniper.github.io/presentations/ds2017/integrating-opendata.html">mjuniper.github.io/presentations/ds2017/integrating-opendata.html</a>
        </div>
      </div>

		</div>

		<script src="../lib/js/head.min.js"></script>
		<script src="../scripts/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
    		controls: false,
				progress: true,
				history: true,
				center: true,
        previewLinks: false,
        transition: 'slide', // default/cube/page/concave/zoom/linear/fade/none
        width: 1600,
        height: 900,
        minScale: 0.2,
        maxScale: 1.0,
        slideNumber: false,

        keyboard: {
          13: function () {
            var curSlide = Reveal.getCurrentSlide();

            els = curSlide.querySelectorAll(':scope > a.follow-link, :scope > h1 > a.follow-link, :scope > h2 > a.follow-link, .fragment.visible > a.follow-link');

            if (els && els.length) {
              var el = els[els.length - 1];
              window.open(el.getAttribute('href'));
            }
          }
        },

				// Optional reveal.js plugins
        dependencies: [
          { src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: '../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: '../plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: '../plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
			});

		</script>

	</body>
</html>
